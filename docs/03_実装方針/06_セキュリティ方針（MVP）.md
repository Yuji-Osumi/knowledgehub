# セキュリティ方針（MVP）

## 目的

本ドキュメントは、KnowledgeHub における **最低限のセキュリティ方針**を定める。

MVP 前提のため、
網羅的な対策ではなく **事故を防ぐための基本方針**に限定する。

---

## 基本スタンス

* セキュリティは「完璧」より「一貫性」
* フレームワーク標準を信頼する
* 必要になった時点で強化する

---

## 認証・セッション管理

### 方針

* Cookie ベースのセッション認証を採用する
* トークンを LocalStorage に保存しない

---

### Cookie 設定方針

* HttpOnly：有効
* Secure：本番では有効
* SameSite：Lax

👉 CSRF 対策は **SameSite による軽減**を前提とする

---

## CSRF 対策

* SameSite=Lax を基本とする
* 明示的な CSRF トークンは MVP では導入しない
* 状態変更系 API は POST / PUT / DELETE のみに限定する

---

## XSS 対策

* React の自動エスケープを信頼する
* `dangerouslySetInnerHTML` は原則禁止
* ユーザー入力をそのまま HTML として保存しない

---

## SQL Injection 対策

* ORM（SQLAlchemy）を基本とする
* 生 SQL は最小限・理由必須
* パラメータバインドを必ず使用する

---

## 入力バリデーション

* Backend 側で必ず検証する
* Pydantic による validation を利用する
* Frontend の検証は UX 改善目的のみ

---

## Secret 管理

* Secret はコードに書かない
* Railway の環境変数で管理する

例：

* DATABASE_URL
* SECRET_KEY

---

## ログと情報漏洩

* パスワード・トークンはログに出さない
* エラーメッセージに内部情報を含めない

---

## 今回やらないこと（明示）

* レートリミット
* WAF
* 権限の細分化
* 詳細な監査ログ

👉 必要になった段階で追加する

---

## 判断に迷った場合

* フレームワークの標準に乗っているか
* 情報を出しすぎていないか
* MVP として過剰でないか

---

この方針は、
**個人開発における現実的な安全ライン**を示すものである。
