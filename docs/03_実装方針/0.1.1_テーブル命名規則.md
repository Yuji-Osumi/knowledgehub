# データベース命名規則 (DB Naming Conventions)

## 1. 基本方針
テーブル設計における基本原則は以下の通りとする。

* **複数形 (Plural):** テーブル名は原則として**複数形**を採用する。
* **スネークケース (snake_case):** 単語はすべて小文字のスネークケースで統一する。
* **実体（エンティティ）を表す名詞を使用:** テーブル名から役割・性質が推測できることを重視する。

**例:**
* `users`
* `articles`
* `folders`

---

## 2. 中間テーブル（多対多）の命名
多対多関係を表す中間テーブル（Join Table）には、関係であることが明示的に分かる命名を採用する。

### 物理名ルール
` <entity_a>_<entity_b>_links `

* **entity_a / entity_b:** 関連するテーブル名の語幹。
* **links:** 関係を表すテーブルであることを明示するために使用。
* **目的:** 将来的に関係テーブルが増えても、実体テーブルと判別しやすくするため。

**例:**
* `article_tag_links`
* `user_role_links`
* `article_reference_links`

---

## 3. 中間テーブルに id を持たせる場合の方針
KnowledgeHubでは、中間テーブルであっても以下の場合はサロゲートキー（id）を持たせることを許可する。

* ログ・監査・調査対象となる可能性がある
* 将来的に関係自体にメタ情報が付与される可能性がある
* ORM（SQLAlchemy）で 1 エンティティとして扱いたい場合

### 必須要件
上記の場合でも、以下を必須とする。
* **物理命名:** 実体テーブルと誤認されないよう、必ず末尾に `_links` を含める。
* **重複防止:** `(entity_a_id, entity_b_id)` の **UNIQUE制約** によって担保する。

---

## 4. 論理名（日本語名）ルール
ER図や設計書における中間テーブルの論理名は、以下の形式で統一する。

### 命名形式
` エンティティ1 − エンティティ2 中間 `

**例:**
* 記事 − タグ 中間
* ユーザー − ロール 中間
* 記事 − 参照記事 中間

---

## 5. カラム命名（補足）
共通で使用するカラム名は以下の通りとする。

| カラム名 | 説明 |
| :--- | :--- |
| `id` | 主キー |
| `<table_name_singular>_id` | 外部キー |
| `public_id` | 外部公開用ID |
| `created_at` | 作成日時 |
| `updated_at` | 更新日時 |
