# 補足：環境変数と設定の分離レベル（MVP方針）

本プロジェクトでは、個人開発・MVP前提として
「安全性を確保しつつ、過剰に複雑化しない」環境変数分離レベルを採用する。

---

## 1. 基本方針

- 環境差分は local / production の2種類のみ
- 機密情報はコードに含めず、環境変数で管理する
- 設定参照はアプリ内で一元管理する
- MVP段階では高度な設定管理や多環境対応は行わない

---

## 2. 環境構成

local        : ローカル開発環境
production   : 本番環境

※ staging / qa 環境は作成しない（MVPとして割り切る）

---

## 3. バックエンド環境変数（例）

| 変数名          | 用途                             |
| --------------- | -------------------------------- |
| APP_ENV         | 実行環境（local / production）   |
| DATABASE_URL    | データベース接続文字列           |
| SESSION_SECRET  | セッション署名用シークレット     |
| COOKIE_SECURE   | Cookie Secure属性                |
| COOKIE_SAMESITE | Cookie SameSite属性              |
| FRONTEND_ORIGIN | 将来拡張用（現時点では未使用可） |

### 運用ルール

- ローカル：`.env.local` を使用（git管理しない）
- 本番：Railway の Environment Variables で管理
- アプリ内では設定クラス経由で参照する
- `os.environ` を直接参照しない

---

## 4. フロントエンド環境変数（例）

| 変数名            | 用途           |
| ----------------- | -------------- |
| VITE_API_BASE_URL | APIのベースURL |

### 運用ルール

- `.env.local` / `.env.production` を使用
- 認証は Cookie ベースのため、トークン系変数は持たない
- API URL 以外の設定は極力持ち込まない

---

## 5. あえて分離しない項目（割り切り）

以下は MVP 段階では分離しない。

- APIエンドポイントのパス定義
- SameSite 値の環境切り替え
- Feature Flag / 機能ON-OFF設定
- 設定管理基盤（Vault 等）

理由：
設計・運用コストに対して得られる価値が小さいため

---

## 6. セキュリティ上の最低ライン

- `.env*` ファイルは必ず `.gitignore`
- 機密情報はデプロイ先（Railway）で管理
- ログ出力に環境変数を含めない

---

## 7. 方針まとめ

- 環境は2種（local / production）
- 設定は環境変数で分離
- 設定取得はアプリ内で一元化
- MVPでは「安全・シンプル・壊れにくい」を優先する
