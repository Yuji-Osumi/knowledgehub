## 認証・認可方針

### 認証方式

- Cookieベースのセッション認証を採用する
- JWTは使用しない
- 認証状態はサーバー側で管理する

本プロジェクトは個人利用を前提としており、
トークン管理や失効戦略を含むJWT認証はMVPとして過剰と判断した。
そのため、実装コストが低く管理しやすいCookieベースのセッション認証を採用する。

---

### セッションCookie設定

- HttpOnly: 有効
  - JavaScriptからのCookieアクセスを禁止し、XSSによるセッション盗難を防止する
- SameSite: Lax
  - 外部サイトからの不正なPOSTリクエストによるCSRF攻撃を抑止する
- Secure: 本番環境のみ有効
  - HTTPS通信時のみCookieを送信する

CSRFトークンは実装せず、
SameSite=Lax による最低限のCSRF対策を行う。

---

### 認証対象API

以下のAPIは認証必須とする。

- POST /auth/logout
- GET /auth/me
- articles / tags / folders / logs に関する全API

未認証状態でアクセスされた場合は `401 Unauthorized` を返却する。

---

### 認証不要API

以下のAPIは認証不要とする。

- POST /auth/login

---

### セキュリティに関する割り切り

- 多端末ログイン管理は行わない
- セッションの同時ログイン制限は行わない
- ログイン試行回数制限やCAPTCHAは実装しない

これらは公開サービスや多ユーザー環境では必要となるが、
本プロジェクトでは個人利用・限定公開を前提としているため非対応とする。

---

### ユーザー識別について

- API上では users.public_id（UUID）をユーザー識別子として扱う
- 内部ID（BIGSERIAL）は外部に公開しない
- user_id はサーバー側でセッションから解決する
