# 0.9 API仕様定義（REST）

## 方針

* 認証方式：Cookieベースのセッション認証
* APIはREST形式
* 外部公開ID（public_id: UUID）をURLパラメータとして使用
* レスポンスはJSON
* MVP優先・例外は最小限に定義

---

## 認証（Auth）

### POST /auth/login

**概要**
メールアドレスとパスワードでログインし、セッションを確立する。

**Request Body**

```json
{
  "email": "user@example.com",
  "password": "password"
}
```

**Response 200**
- Set-Cookie ヘッダ（HttpOnly）
```json
{
  "id": "uuid",
  "email": "user@example.com"
}
```

**Error**

- 400: 入力不正
- 401: 認証失敗（メール or パスワード不正）

---

### GET /auth/me

**概要**
ログイン中のユーザー情報を取得する。

**Auth**

* 必須

**Response 200**

```json
{
  "id": "uuid",
  "email": "user@example.com"
}
```

**Error**

* 401: 未ログイン

---

### POST /auth/logout

**概要**
セッションを破棄してログアウトする。

**Auth**

* 必須

**Response 204**

---

## 記事（Articles）

### GET /articles

**概要**
記事一覧を取得する。

**Query Params**

* folder_id（optional, UUID）
* tag_id（optional, UUID）

**Auth**

* 必須

**Response 200**

```json
[
  {
    "id": "uuid",
    "title": "Sample",
    "updated_at": "2025-01-01T00:00:00"
  }
]
```

---

### POST /articles

**概要**
記事を新規作成する。

**Request Body**

```json
{
  "title": "Title",
  "content": "Markdown text",
  "folder_id": "uuid"
}
```

**Response 201**

```json
{
  "id": "uuid"
}
```

---

### GET /articles/{id}

**概要**
記事詳細を取得する。

**Path Param**

* id: 記事public_id

**Auth**

* 必須

**Response 200**

```json
{
  "id": "uuid",
  "title": "Title",
  "content": "Markdown text",
  "tags": ["tag1", "tag2"]
}
```

---

### PUT /articles/{id}

**概要**
記事を更新する（更新時にversionを作成）。

**Request Body**

```json
{
  "title": "Updated",
  "content": "Updated content",
  "folder_id": "uuid"
}
```

**Response 200**

```json
{
  "id": "uuid"
}
```

---

### DELETE /articles/{id}

**概要**
記事を削除する（物理削除）。

**Response 204**

---

## 検索（Search）

### GET /search

**概要**
全文検索を行う。

**Query Params**

* q: 検索クエリ

**Response 200**

```json
[
  {
    "id": "uuid",
    "title": "Matched title"
  }
]
```

---

## タグ（Tags）

### GET /tags

### POST /tags

### DELETE /tags/{id}

---

## フォルダ（Folders）

### GET /folders

### POST /folders

### PUT /folders/{id}

### DELETE /folders/{id}

---

## バージョン（Article Versions）※拡張

### GET /articles/{id}/versions

---

## 操作ログ（Operation Logs）※拡張

### GET /logs
